# =============================================================================
# CONFIGMAP - APPLICATION CONFIGURATION
# =============================================================================
# MAINTAINABILITY: Externalize configuration from container images
# Allows changing config without rebuilding images

apiVersion: v1
kind: ConfigMap
metadata:
  name: sample-app-config             # Name of the ConfigMap
  namespace: sample-app               # Must match application namespace
  labels:
    app.kubernetes.io/name: sample-app
    app.kubernetes.io/component: config
data:
  # Application configuration (non-sensitive data only)
  APP_ENV: "development"              # Environment identifier
  LOG_LEVEL: "info"                   # Logging verbosity
  ENABLE_METRICS: "true"              # Enable Prometheus metrics
  SERVER_PORT: "80"                   # Port the application listens on
  
  # Database connection (non-sensitive parts)
  DB_HOST: "psql-cloud-example.postgres.database.azure.com"
  DB_PORT: "5432"
  DB_NAME: "appdb"
  DB_SSL_MODE: "require"              # SECURITY: Always use SSL for database connections

---
# =============================================================================
# SECRET - SENSITIVE CREDENTIALS
# =============================================================================
# SECURITY: Store sensitive data as Kubernetes Secrets
# Note: In production, use Azure Key Vault with CSI driver instead

apiVersion: v1
kind: Secret
metadata:
  name: sample-app-secrets            # Name of the Secret
  namespace: sample-app               # Must match application namespace
  labels:
    app.kubernetes.io/name: sample-app
    app.kubernetes.io/component: secrets
  annotations:
    # SECURITY: Indicate this secret should be synced from Key Vault
    # azure.workload.identity/use: "true"
    description: "Sensitive credentials for sample-app"
type: Opaque                          # Generic secret type
data:
  # SECURITY: Values must be base64 encoded
  # Example: echo -n 'psqladmin' | base64
  DB_USER: cHNxbGFkbWlu             # Base64 encoded database username
  DB_PASSWORD: ""                     # SECURITY: Leave empty - inject from Key Vault in production
  
  # Alternative: Use stringData for plain text (Kubernetes will encode it)
  # stringData:
  #   DB_USER: "psqladmin"
