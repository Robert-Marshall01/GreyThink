<BACKUP of fortran_calculus.f90 created by assistant on 2025-11-28>

(The real backup contains the full original source; use the .f90 in the workspace as primary.)